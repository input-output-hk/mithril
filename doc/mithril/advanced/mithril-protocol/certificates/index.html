<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-maintained docs-doc-page docs-doc-id-mithril/advanced/mithril-protocol/certificates" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Certificate chain design | Mithril. A complete guide.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mithril.network/doc/mithril/advanced/mithril-protocol/certificates"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:image" content="https://mithril.network/doc/img/logo.png"><meta data-rh="true" name="docusaurus_version" content="maintained"><meta data-rh="true" name="docusaurus_tag" content="docs-default-maintained"><meta data-rh="true" name="docsearch:version" content="maintained"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-maintained"><meta data-rh="true" property="og:title" content="Certificate chain design | Mithril. A complete guide."><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/doc/img/mithril-logo.svg"><link data-rh="true" rel="canonical" href="https://mithril.network/doc/mithril/advanced/mithril-protocol/certificates"><link data-rh="true" rel="alternate" href="https://mithril.network/doc/mithril/advanced/mithril-protocol/certificates" hreflang="en"><link data-rh="true" rel="alternate" href="https://mithril.network/doc/mithril/advanced/mithril-protocol/certificates" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Advanced","item":"https://mithril.network/doc/mithril/advanced/"},{"@type":"ListItem","position":2,"name":"Mithril protocol","item":"https://mithril.network/doc/mithril/advanced/mithril-protocol/"},{"@type":"ListItem","position":3,"name":"Certificate chain design","item":"https://mithril.network/doc/mithril/advanced/mithril-protocol/certificates"}]}</script><link rel="alternate" type="application/rss+xml" href="/doc/dev-blog/rss.xml" title="Mithril. A complete guide. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc/dev-blog/atom.xml" title="Mithril. A complete guide. Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4MB41WL2Z2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4MB41WL2Z2",{anonymize_ip:!0})</script>






<link rel="alternate" type="application/rss+xml" href="/doc/adr/rss.xml" title="Mithril. A complete guide. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc/adr/atom.xml" title="Mithril. A complete guide. Atom Feed">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="https://plausible.io/js/script.js" defer="defer" data-domain="mithril.network"></script><link rel="stylesheet" href="/doc/assets/css/styles.a25f281a.css">
<script src="/doc/assets/js/runtime~main.bad1af15.js" defer="defer"></script>
<script src="/doc/assets/js/main.c6df415c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#2A598E;color:#f1f1f1" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">Participate in Mithril Protocolâ€™s Mainnet Beta! Follow our SPO on-boarding guide  <a rel="noopener noreferrer" href="https://mithril.network/doc/manual/operate/become-mithril-spo">here</a>!</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><header aria-label="Main" class="flex navbar tablet:py-[30px] !px-0 shadow-none z-50 border-b border-[#EAEAEB] pt-3 pb-4 tablet:px-2 navbar--fixed-top"><div class="w-full px-6"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/doc/"><div class="navbar__logo"><img src="/doc/img/mithril-logo-text.svg" alt="Mithril. A complete guide." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc/img/mithril-logo-text.svg" alt="Mithril. A complete guide." class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/doc/manual/welcome">User manual</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/doc/mithril/intro">About Mithril</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/doc/mithril/advanced/mithril-protocol/certificates">Current</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/next/mithril/advanced/mithril-protocol/certificates">Next ðŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/doc/mithril/advanced/mithril-protocol/certificates">Current</a></li></ul></div><a href="https://mithril.network/explorer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Explorer</a><a class="navbar__item navbar__link" href="/doc/glossary">Glossary</a><a class="navbar__item navbar__link" href="/doc/dev-blog">Blog</a><a class="navbar__item navbar__link" href="/doc/adr">ADRs</a><div class="navbarSearchContainer_Bca1"></div><a href="https://github.com/input-output-hk/mithril/" target="_blank" rel="noopener noreferrer" class="hover:text-[var(--ifm-navbar-link-hover-color)] mx-3 py-1 laptop:flex hidden"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="24" viewBox="0 0 26 24"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.241 0C6.45096 0 0.961914 5.49998 0.961914 12.3042C0.961914 17.7432 4.47894 22.3472 9.35798 23.9767C9.96799 24.0991 10.1914 23.7119 10.1914 23.3862C10.1914 23.1009 10.1713 22.1232 10.1713 21.1044C6.75559 21.8379 6.04429 19.6377 6.04429 19.6377C5.49536 18.2117 4.68202 17.8452 4.68202 17.8452C3.56405 17.0914 4.76346 17.0914 4.76346 17.0914C6.00358 17.1729 6.6543 18.3544 6.6543 18.3544C7.75191 20.2284 9.5206 19.6989 10.2321 19.3729C10.3337 18.5784 10.6592 18.0284 11.0048 17.7229C8.28048 17.4377 5.41418 16.3784 5.41418 11.6522C5.41418 10.3077 5.90178 9.20771 6.67441 8.35222C6.55251 8.04672 6.12548 6.78347 6.79656 5.09273C6.79656 5.09273 7.83334 4.76673 10.1711 6.35572C11.1719 6.08639 12.2041 5.94938 13.241 5.94823C14.2777 5.94823 15.3346 6.09097 16.3106 6.35572C18.6486 4.76673 19.6854 5.09273 19.6854 5.09273C20.3564 6.78347 19.9292 8.04672 19.8073 8.35222C20.6002 9.20771 21.0677 10.3077 21.0677 11.6522C21.0677 16.3784 18.2014 17.4172 15.4568 17.7229C15.9042 18.1099 16.2902 18.8432 16.2902 20.0044C16.2902 21.6544 16.2701 22.9787 16.2701 23.3859C16.2701 23.7119 16.4938 24.0991 17.1036 23.9769C21.9826 22.3469 25.4996 17.7432 25.4996 12.3042C25.5198 5.49998 20.0106 0 13.241 0Z" fill="currentColor"></path></svg></a><a href="https://discord.gg/5kaErDKDRq" target="_blank" rel="noopener noreferrer" class="hover:text-[var(--ifm-navbar-link-hover-color)] mx-3 py-1 laptop:flex hidden"><svg xmlns="http://www.w3.org/2000/svg" width="23" height="18" viewBox="0 0 23 18"><path d="M19.4778 1.49632C18.0074 0.806713 16.4357 0.286253 14.7879 0C14.7626 0 14.7246 0 14.7119 0.0390345C14.5091 0.403356 14.2809 0.884782 14.1288 1.27513C12.3543 1.00189 10.6051 1.00189 8.8686 1.27513C8.71649 0.884782 8.47566 0.416368 8.27286 0.0390345C8.26019 0.0130115 8.22216 0 8.19681 0C6.54903 0.286253 4.9773 0.793701 3.51965 1.49632C3.50697 1.49632 3.4943 1.50933 3.4943 1.52234C0.50294 6.08938 -0.308275 10.5523 0.0973328 14.9632C0.0973328 14.9892 0.110008 15.0023 0.122683 15.0153C2.08734 16.4986 4.00131 17.3964 5.86457 17.9949C5.88992 17.9949 5.92794 17.9949 5.94062 17.9689C6.38425 17.3443 6.77718 16.6937 7.11941 16.0041C7.14476 15.9651 7.11941 15.9131 7.08139 15.9C6.4603 15.6528 5.86457 15.3536 5.2815 15.0283C5.2308 15.0023 5.2308 14.9372 5.2815 14.8982C5.40826 14.8071 5.52233 14.703 5.63641 14.6119C5.66176 14.5989 5.68711 14.5859 5.71246 14.6119C9.47701 16.3815 13.5584 16.3815 17.2723 14.6119C17.2976 14.6119 17.323 14.6119 17.3483 14.6119C17.4624 14.703 17.5892 14.8071 17.7032 14.8982C17.7413 14.9242 17.7413 15.0023 17.7032 15.0283C17.1328 15.3666 16.5371 15.6658 15.9034 15.9C15.8653 15.9131 15.84 15.9651 15.8653 16.0041C16.2076 16.6937 16.6005 17.3443 17.0441 17.9689C17.0568 17.9949 17.0948 18.0079 17.1202 17.9949C18.9961 17.3964 20.9101 16.4986 22.8747 15.0153C22.8874 15.0023 22.9001 14.9762 22.9001 14.9632C23.3817 9.86271 22.1015 5.4388 19.5031 1.52234C19.5031 1.50933 19.4904 1.49632 19.4778 1.49632ZM7.6898 12.2828C6.5617 12.2828 5.62374 11.2159 5.62374 9.90175C5.62374 8.58759 6.53635 7.52064 7.6898 7.52064C8.84325 7.52064 9.78121 8.6006 9.75586 9.90175C9.75586 11.2159 8.84325 12.2828 7.6898 12.2828ZM15.333 12.2828C14.2049 12.2828 13.2669 11.2159 13.2669 9.90175C13.2669 8.58759 14.1795 7.52064 15.333 7.52064C16.4864 7.52064 17.4244 8.6006 17.399 9.90175C17.399 11.2159 16.4864 12.2828 15.333 12.2828Z" fill="currentColor"></path></svg></a><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></header><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/mithril/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/doc/mithril/beginner/">Beginner</a><button aria-label="Collapse sidebar category &#x27;Beginner&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/beginner/mithril-in-a-nutshell">Mithril in a nutshell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/beginner/why-use-mithril">Why should you use Mithril?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/beginner/how-it-works">How it works</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/doc/mithril/advanced/">Advanced</a><button aria-label="Collapse sidebar category &#x27;Advanced&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/doc/mithril/advanced/mithril-protocol/">Mithril protocol</a><button aria-label="Collapse sidebar category &#x27;Mithril protocol&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-protocol/protocol">Protocol phases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/doc/mithril/advanced/mithril-protocol/certificates">Certificate chain design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-protocol/security">Protocol security</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/doc/mithril/advanced/mithril-certification/">Mithril certification</a><button aria-label="Collapse sidebar category &#x27;Mithril certification&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-certification/cardano-transactions">Cardano transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-certification/cardano-stake-distribution">Cardano stake distribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-certification/cardano-node-database">Cardano node database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-certification/cardano-node-database-v2">Cardano node database v2</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/doc/mithril/advanced/mithril-network/">Mithril network</a><button aria-label="Collapse sidebar category &#x27;Mithril network&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-network/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-network/aggregator">Mithril aggregator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-network/signer">Mithril signer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/mithril-network/client">Mithril client</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/mithril/advanced/threat-model">Threat model analysis</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/doc/mithril/advanced/"><span>Advanced</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/doc/mithril/advanced/mithril-protocol/"><span>Mithril protocol</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Certificate chain design</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Current</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Certificate chain design</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">â€‹</a></h2>
<p>The <strong>certificate chain</strong> is a Mithril component that certifies the <strong>stake distribution</strong> used to create the multi-signature. Its primary purpose is to prevent adversaries from executing an <strong>eclipse attack</strong> on the blockchain.</p>
<p>Without the certificate, the stake distribution can&#x27;t be trusted. A malicious actor could relatively easily create a fake stake distribution and use it to produce a valid multi-signature, which would be embedded in a valid but non-genuine certificate. This certificate could be served by a dishonest Mithril aggregator node, leading an honest Mithril client to restore a non-genuine snapshot.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-certificate-chain-design">The certificate chain design<a href="#the-certificate-chain-design" class="hash-link" aria-label="Direct link to The certificate chain design" title="Direct link to The certificate chain design">â€‹</a></h2>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>The stake distribution of an epoch is computed by <strong>Cardano nodes</strong> at the end of each epoch. It becomes usable from the beginning of the following epoch.</p></div></div>
<p>The way to certify the stake distribution used to create a multi-signature is by verifying that it has been previously signed in an earlier certificate. Then, one can recursively verify that the earlier certificate is valid in the same manner. This process can be structured as a chain of certificates, known as the Mithril certificate chain. The first certificate in the chain is discussed below.</p>
<p>Since multiple certificates can be created during the same epoch using the same stake distribution, it is not necessary to link to all of them for verification. Instead, it is sufficient to link to only one certificate from the previous epoch. By doing so, the verification process becomes faster and helps avoid network congestion.</p>
<p>The first certificate in the certificate chain is known as the <strong>genesis certificate</strong>. Validating the stake distribution embedded in the genesis certificate is only possible by signing it with a private key linked to a widely accessible public key called the <strong>genesis key</strong>. The use of these specific keys ensures the integrity and security of the initial stake distribution and subsequent transitions within the blockchain network.</p>
<p>The diagram below presents the certificate chain design:
<a href="/doc/assets/files/certificate-chain-fa3c0aaec7a2ec024c1c06e6226017b9.jpg" target="_blank"><img decoding="async" loading="lazy" alt="Certificate Chain Design" src="/doc/assets/images/certificate-chain-fa3c0aaec7a2ec024c1c06e6226017b9.jpg" width="1513" height="660" class="img_ev3q"></a></p>
<p>Where the following notations have been used:</p>
<ul>
<li><code>C(p,n)</code>: Certificate at trigger <code>p</code> and epoch <code>n</code></li>
<li><code>FC(n)</code>: First certificate of epoch <code>n</code></li>
<li><code>GC</code>: Genesis certificate</li>
<li><code>H()</code>: Hash</li>
<li><code>SD(n)</code>: Stake distribution of epoch <code>n</code></li>
<li><code>VK(n)</code>: Verification key at epoch <code>n</code></li>
<li><code>AVK(n)</code>: Aggregrate verification key at epoch <code>n</code> such as <code>AVK(n) = MKT_ROOT(SD(n) || VK(n))</code></li>
<li><code>MKT_ROOT()</code>: Merkle-tree root</li>
<li><code>PPARAMS(n)</code>: Protocol parameters at epoch <code>n</code></li>
<li><code>EPOCH(n)</code>: Epoch <code>n</code></li>
<li><code>BEACON(p,n)</code>: Beacon at trigger <code>p</code> and epoch <code>n</code> (includes <code>EPOCH(n)</code>)</li>
<li><code>METADATA(p,n)</code>: Metadata of the certificate at trigger <code>p</code> and epoch <code>n</code></li>
<li><code>MSG(p,n)</code>: Message of the certificate at trigger <code>p</code> and epoch <code>n</code></li>
<li><code>MULTI_SIG(p,n)</code>: Multi-signature created to the message <code>H(MSG(p,n) || AVK(n-1))</code></li>
<li><code>GENESIS_SIG(MSG)</code>: Genesis signature, the signature of <code>MSG</code> with the genesis keys</li>
</ul>
<p>The hash of a certificate <code>H(C(p,n))</code> is computed as the concatenation (<code>||</code>) of all its fields. Therefore, if one field is modified, its hash is different.</p>
<p>Information embedded in the <code>METADATA(p,n)</code> field:</p>
<ul>
<li>The version of the Mithril protocol</li>
<li>The parameters of the Mithril protocol (<code>k</code>, <code>m</code>, and <code>phi_f</code>)</li>
<li>The date and time at which the multi-signature creation was initiated</li>
<li>The date and time at which the certificate was sealed</li>
<li>The list of the signers that actively contributed to the multi-signature.</li>
</ul>
<p>The message <code>MSG(p,n)</code> is a map of multiple values associated with their respective keys. It provides a way to add more information to the certificates without breaking the chain itself. Added items can be any message that the signers can compute deterministically thanks to the Cardano consensus â€“ an immutable files snapshot, the UTXO set, stake distribution, etc.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The <strong>trigger</strong> represents the instant at which a certificate should be created. It is combined with at least the associated <strong>epoch</strong> to create a <a href="/doc/glossary#beacon"><strong>beacon</strong></a> of the certificate. In the current implementation of the Cardano node database snapshot, this trigger is a new <a href="/doc/glossary#immutable-file-number"><strong>immutable file number</strong></a>.</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The <strong>aggregate verification key</strong> (<code>AVK</code>) is the root of the Merkle tree where each leaf is filled with <code>H(STAKE(signer) || VK(signer))</code>. It represents the corresponding stake distribution in a condensed way.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-verification-algorithm">The verification algorithm<a href="#the-verification-algorithm" class="hash-link" aria-label="Direct link to The verification algorithm" title="Direct link to The verification algorithm">â€‹</a></h2>
<p>Certificate chain verification can be stated as:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CHAIN_VERIFY[C(p,n(p))] = CERT_VERIFY[C(p,n(p)] ^ CERT_VERIFY[FC(n(p))] ^ CERT_VERIFY[FC(n(p)-1)] ^ ... ^ CERT_VERIFY[FC(1)] ^ CERT_VERIFY[GC]</span><br></span></code></pre></div></div>
<p>Where the following notations have been used:</p>
<ul>
<li>The epoch <code>n(p)</code> depends on the trigger <code>p</code></li>
<li><code>CHAIN_VERIFY[]</code>: verify all the chain backward from a certificate</li>
<li><code>CERT_VERIFY[]</code>: verify a specific certificate.</li>
</ul>
<p>A certificate chain is considered valid when there is at least one valid certificate per epoch, starting from a certificate and going all the way up to the genesis certificate of the chain.</p>
<p>A <strong>non-genesis certificate</strong> is valid if and only if the <code>AVK</code> used to verify the multi-signature is also part of the signed message used to create a valid multi-signature in a previously sealed certificate.</p>
<p>The genesis certificate is valid if and only if its genesis signature is verified with the advertised public genesis key.</p>
<p>An implementation of the algorithm would work as follows for a certificate:</p>
<ul>
<li><strong>Step 1</strong>: Use this certificate as the <code>current_certificate</code></li>
<li><strong>Step 2</strong>: Verify (or fail) that the <code>current_hash</code> of the <code>current_certificate</code> is valid by computing it and comparing it with the <code>hash</code> field of the certificate</li>
<li><strong>Step 3</strong>: Get the <code>previous_hash</code> of the <code>previous_certificate</code> by reading its value in the <code>current_certificate</code></li>
<li><strong>Step 4</strong>: Verify (or fail) that the <code>multi_signature</code> of the <code>current_certificate</code> is valid</li>
<li><strong>Step 5</strong>: Verify (or fail) that the <code>current_epoch</code> of the <code>current_certificate</code> is part of the message signed by the multi-signature of the <code>current_certificate</code></li>
<li><strong>Step 6</strong>: Retrieve the <code>previous_certificate</code> that has the hash <code>previous_hash</code>:<!-- -->
<ul>
<li><strong>Step 6.1</strong>: If it is not a <code>genesis_certificate</code>:<!-- -->
<ul>
<li><strong>Step 6.1.1</strong>: Verify (or fail) that the <code>previous_hash</code> of the <code>previous_certificate</code> is valid by computing it and comparing it with the <code>hash</code> field of the certificate:</li>
<li><strong>Step 6.1.2</strong>: Verify the <code>current_avk</code>:<!-- -->
<ul>
<li><strong>Step 6.1.2.1</strong>: If the <code>current_certificate</code> is the <code>first_certificate</code> of the epoch<!-- -->
<ul>
<li><strong>Step 6.1.2.1.1</strong>: Verify (or fail) that the <code>current_avk</code> of the <code>current_certificate</code> is part of the message signed by the multi-signature of the <code>previous_certificate</code></li>
<li><strong>Step 6.1.2.1.2</strong>: Verify (or fail) that the <code>current_protocol_parameters</code> of the <code>current_certificate</code> is part of the message signed by the multi-signature of the <code>previous_certificate</code></li>
</ul>
</li>
<li><strong>Step 6.1.2.2</strong>: Else verify (or fail) that the <code>current_avk</code> of the <code>current_certificate</code> is the same as the <code>current_avk</code> of the <code>previous_certificate</code></li>
</ul>
</li>
<li><strong>Step 6.1.3</strong>: Verify (or fail) that the <code>multi_signature</code> of the <code>previous_certificate</code> is valid</li>
<li><strong>Step 6.1.4</strong>: Use the <code>previous_certificate</code> as <code>current_certificate</code> and start again at <strong>Step 2</strong></li>
</ul>
</li>
<li><strong>Step 6.2</strong>: If it is a <code>genesis_certificate</code>:<!-- -->
<ul>
<li><strong>Step 6.2.1</strong>: Verify (or fail) that the <code>previous_hash</code> of the <code>previous_certificate</code> is valid by computing it and comparing it with the <code>hash</code> field of the certificate</li>
<li><strong>Step 6.2.2</strong>: Verify (or fail) that the <code>current_epoch</code> of the <code>previous_certificate</code> is part of the message signed by the genesis_certificate of the <code>previous_certificate</code></li>
<li><strong>Step 6.2.3</strong>: Verify (or fail) that the <code>current_avk</code> of the <code>current_certificate</code> is part of the message signed by the genesis signature of the <code>previous_certificate</code></li>
<li><strong>Step 6.2.4</strong>: Verify (or fail) that the <code>current_protocol_parameters</code> of the <code>current_certificate</code> is part of the message signed by the genesis signature of the <code>previous_certificate</code></li>
<li><strong>Step 6.2.5</strong>: The certificate is valid (success).</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-coexistence-of-multiple-certificate-chains">The coexistence of multiple certificate chains<a href="#the-coexistence-of-multiple-certificate-chains" class="hash-link" aria-label="Direct link to The coexistence of multiple certificate chains" title="Direct link to The coexistence of multiple certificate chains">â€‹</a></h2>
<p>What would happen if some <strong>Mithril aggregator</strong> claims that not enough signatures were received? This doesnâ€™t really matter, as there will be a different Mithril aggregator that would collect sufficient signatures and aggregate them into a valid certificate.</p>
<p>Similarly, different Mithril aggregators might have different views of the individual signatures submitted (one aggregator might receive 10 signatures, and a different one could receive 11), which would result in different certificates signing the same message.</p>
<p>This would result in different certificate chains that would all link back to the genesis certificate. Indeed they would be represented by a tree of certificates where each traversal path from the root to a leaf represents a valid certificate chain.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-need-for-backward-compatibility">The need for backward compatibility<a href="#the-need-for-backward-compatibility" class="hash-link" aria-label="Direct link to The need for backward compatibility" title="Direct link to The need for backward compatibility">â€‹</a></h2>
<p>The certificate chain is designed to last. At a certain point, a multi-signature from legacy versions of the Mithril cryptographic library will require certification.</p>
<p>To achieve this backward compatibility, some options are available:</p>
<ul>
<li>Handle multi-signature verification functions of legacy versions</li>
<li>Recreate genesis certificates from time to time</li>
<li>Create intermediate <strong>milestone certificates</strong> (with both a multi-signature and a genesis signature)</li>
<li>Design a format migration algorithm.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/input-output-hk/mithril/edit/main/docs/website/root/mithril/advanced/mithril-protocol/certificates.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/doc/mithril/advanced/mithril-protocol/protocol"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Protocol phases</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/doc/mithril/advanced/mithril-protocol/security"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Protocol security</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#the-certificate-chain-design" class="table-of-contents__link toc-highlight">The certificate chain design</a></li><li><a href="#the-verification-algorithm" class="table-of-contents__link toc-highlight">The verification algorithm</a></li><li><a href="#the-coexistence-of-multiple-certificate-chains" class="table-of-contents__link toc-highlight">The coexistence of multiple certificate chains</a></li><li><a href="#the-need-for-backward-compatibility" class="table-of-contents__link toc-highlight">The need for backward compatibility</a></li></ul></div></div></div></div></main></div></div></div><footer class="bg-blue"><div class="pageContainer py-14 text-gray-extra-light"><div class="laptop:flex laptop:flex-row tablet:grid tablet:grid-cols-2 laptop:gap-[6.25rem] gap-y-7 flex flex-col text-sm pb-12 tablet:pb-[3.625rem]"><div class="flex flex-col gap-6"><div class="font-bold min-h-5">Contributing</div><ul class="flex flex-col gap-6"><li class="footer__item"><a href="https://github.com/input-output-hk/mithril/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="">Contributing guidelines</a></li><li class="footer__item"><a class="" href="/doc/adr">Architectural Decision Records</a></li></ul></div><div class="flex flex-col gap-6"><div class="font-bold min-h-5">Community</div><ul class="flex flex-col gap-6"><li class="footer__item"><a href="https://discord.gg/5kaErDKDRq" target="_blank" rel="noopener noreferrer" class="">Discord (#ask-mithril)</a></li><li class="footer__item"><a href="https://github.com/input-output-hk/mithril/discussions" target="_blank" rel="noopener noreferrer" class="">GitHub discussions</a></li><li class="footer__item"><a href="https://cardano.stackexchange.com/search?q=mithril" target="_blank" rel="noopener noreferrer" class="">Stack Exchange</a></li></ul></div><div class="flex flex-col gap-6"><div class="font-bold min-h-5">More</div><ul class="flex flex-col gap-6"><li class="footer__item"><a href="https://mithril.cronitorstatus.com/" target="_blank" rel="noopener noreferrer" class="">Mithril networks status</a></li><li class="footer__item"><a href="https://lookerstudio.google.com/s/mbL23-8gibI" target="_blank" rel="noopener noreferrer" class="">Mithril protocol insights</a></li><li class="footer__item"><a href="https://github.com/input-output-hk/mithril/wiki/Logbook" target="_blank" rel="noopener noreferrer" class="">Logbook</a></li><li class="footer__item"><a href="https://iohk.io/en/blog" target="_blank" rel="noopener noreferrer" class="">Input Output (Blog)</a></li></ul></div><div class="flex flex-col gap-6"><div class="font-bold min-h-5">Legal</div><ul class="flex flex-col gap-6"><li class="footer__item"><a href="https://static.iohk.io/terms/iog-privacy-policy.pdf" target="_blank" rel="noopener noreferrer" class="">Privacy policy</a></li><li class="footer__item"><a href="https://static.iohk.io/terms/iog-terms-and-conditions.pdf" target="_blank" rel="noopener noreferrer" class="">Terms and conditions</a></li></ul></div></div><div class="flex tablet:items-center gap-2 tablet:flex-row flex-col text-gray-dark tablet:justify-between tablet:pt-4 tablet:border-t border-t-gray-dark"><div class="margin-bottom--sm"><div class="flex items-center text-2xl tracking-[-0.01125rem] gap-1"><img src="/doc/img/mithril-logo-dark.svg" alt="Mithril. A complete guide." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc/img/mithril-logo-dark.svg" alt="Mithril. A complete guide." class="themedComponent_mlkZ themedComponent--dark_xIcU"><h4>Mithril</h4></div></div><div class="footer__copyright">Copyright Â© 2025 IOG, Inc.</div></div></div></footer></div>
</body>
</html>