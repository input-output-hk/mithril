"use strict";(self.webpackChunkmithril_doc=self.webpackChunkmithril_doc||[]).push([[9687],{93126:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"mithril/advanced/threat-model","title":"Threat model analysis","description":"This is a draft version of the Mithril threat model, prepared by the Mithril core team. It is open for external feedback and contributions before being finalized.","source":"@site/versioned_docs/version-maintained/mithril/advanced/threat-model.md","sourceDirName":"mithril/advanced","slug":"/mithril/advanced/threat-model","permalink":"/doc/mithril/advanced/threat-model","draft":false,"unlisted":false,"editUrl":"https://github.com/input-output-hk/mithril/edit/main/docs/website/root/mithril/advanced/threat-model.md","tags":[],"version":"maintained","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"sidebar_label":"Threat model analysis"},"sidebar":"mithrilSideBar","previous":{"title":"Mithril client","permalink":"/doc/mithril/advanced/mithril-network/client"}}');var s=n(74848),t=n(28453);const a={sidebar_position:3,sidebar_label:"Threat model analysis"},l="Threat model analysis",o={},d=[{value:"System analysis",id:"system-analysis",level:2},{value:"System description",id:"system-description",level:3},{value:"Deployment architecture",id:"deployment-architecture",level:4},{value:"External dependencies",id:"external-dependencies",level:3},{value:"Entry points",id:"entry-points",level:3},{value:"Assumptions",id:"assumptions",level:2},{value:"Assets",id:"assets",level:2},{value:"KES private keys",id:"kes-private-keys",level:4},{value:"Block diffusion",id:"block-diffusion",level:4},{value:"Block production",id:"block-production",level:4},{value:"Cardano chain database",id:"cardano-chain-database",level:4},{value:"Cardano ledger state",id:"cardano-ledger-state",level:4},{value:"Mithril signing keys",id:"mithril-signing-keys",level:4},{value:"Mithril signers registration",id:"mithril-signers-registration",level:4},{value:"Mithril signature diffusion",id:"mithril-signature-diffusion",level:4},{value:"Mithril protocol parameters",id:"mithril-protocol-parameters",level:4},{value:"Mithril genesis signing key",id:"mithril-genesis-signing-key",level:4},{value:"Era configuration files",id:"era-configuration-files",level:4},{value:"Era activation",id:"era-activation",level:4},{value:"Era verification key",id:"era-verification-key",level:4},{value:"Era signing key",id:"era-signing-key",level:4},{value:"Client-side only assets",id:"client-side-only-assets",level:3},{value:"Mithril certificate verification process",id:"mithril-certificate-verification-process",level:4},{value:"Mithril certificates",id:"mithril-certificates",level:4},{value:"Mithril artifacts",id:"mithril-artifacts",level:4},{value:"Mithril genesis verification key",id:"mithril-genesis-verification-key",level:4},{value:"Threats and mitigations",id:"threats-and-mitigations",level:2},{value:"Resource exhaustion on Cardano relay",id:"resource-exhaustion-on-cardano-relay",level:3},{value:"Block diffusion exhaustion",id:"block-diffusion-exhaustion",level:4},{value:"Resource exhaustion on Cardano block producer",id:"resource-exhaustion-on-cardano-block-producer",level:3},{value:"Block production exhaustion",id:"block-production-exhaustion",level:4},{value:"Resource exhaustion on Mithril aggregator",id:"resource-exhaustion-on-mithril-aggregator",level:3},{value:"Integrity of the Cardano block producer database",id:"integrity-of-the-cardano-block-producer-database",level:3},{value:"References",id:"references",level:2}];function c(e){const i={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"threat-model-analysis",children:"Threat model analysis"})}),"\n",(0,s.jsxs)(i.admonition,{type:"danger",children:[(0,s.jsxs)(i.p,{children:["This is a draft version of the ",(0,s.jsx)(i.strong,{children:"Mithril threat model"}),", prepared by the ",(0,s.jsx)(i.strong,{children:"Mithril core team"}),". It is open for external feedback and contributions before being finalized."]}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["To contribute, use the ",(0,s.jsx)(i.strong,{children:"Edit this page"})," option at the bottom of the page."]}),"\n",(0,s.jsxs)(i.li,{children:["If you discover a security vulnerability, report it responsibly by following the ",(0,s.jsx)(i.a,{href:"https://github.com/input-output-hk/mithril/blob/main/SECURITY.md",children:"security vulnerability disclosure policy"}),"."]}),"\n"]})]}),"\n",(0,s.jsx)(i.p,{children:"This document provides an analysis of various security threats and possible mitigations affecting the Mithril network and its participants. It adopts an adversarial mindset, analyzing the system from an attacker's perspective."}),"\n",(0,s.jsxs)(i.p,{children:["The threat model is a living document, updated to reflect the ",(0,s.jsx)(i.a,{href:"https://github.com/input-output-hk/mithril/releases/latest",children:"latest Mithril version"}),"."]}),"\n",(0,s.jsx)(i.h2,{id:"system-analysis",children:"System analysis"}),"\n",(0,s.jsx)(i.h3,{id:"system-description",children:"System description"}),"\n",(0,s.jsx)(i.admonition,{title:"To do",type:"info",children:(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Consider reducing these details and moving them into the ",(0,s.jsx)(i.a,{href:"https://mithril.network/doc/mithril/mithril-network/architecture",children:"architecture page"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Also consider updating the ",(0,s.jsx)(i.a,{href:"https://mithril.network/doc/mithril/mithril-protocol/protocol",children:"protocol page"}),"."]}),"\n"]})}),"\n",(0,s.jsx)(i.p,{children:"The system consists of three main components: signers, aggregators, and clients."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Mithril signers"})," certify Cardano chain data by using a Mithril signing key. They must have access to both a trusted ",(0,s.jsx)(i.code,{children:"cardano-node"})," and the Mithril signing key to operate."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Mithril signing keys"})," are rotated every epoch and require certification by the Cardano KES key. Therefore, Mithril signers must have access to the KES key to register a signing key for each epoch."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Cardano KES keys"})," are also used by the block-producing ",(0,s.jsx)(i.code,{children:"cardano-node"})," and are typically located on the same machine that produces blocks. These keys must be evolved every 36 hours, although they can be rotated from a root key when needed. For more details, see ",(0,s.jsx)(i.a,{href:"https://github.com/input-output-hk/cardano-node-wiki/blob/main/docs/stake-pool-operations/7_KES_period.md",children:"KES period documentation"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.admonition,{title:"To do",type:"info",children:(0,s.jsx)(i.p,{children:"Is there a Cardano threat model available for this?"})}),"\n",(0,s.jsx)(i.p,{children:"All Mithril signers and Mithril clients connect to a single aggregator using HTTP over TLS."}),"\n",(0,s.jsx)(i.p,{children:"Registering a Mithril signing key means that a signer sends its corresponding verification key to the aggregator, for the purpose of distribution to all other Mithril signers."}),"\n",(0,s.jsx)(i.p,{children:"Each Mithril signer checks if there is something that can be signed independently, produces a signature of what's needed to sign and submits that to the aggregator (which verifies the signature being correct upon receiving)."}),"\n",(0,s.jsx)(i.p,{children:"The aggregator repeatedly checks whether enough valid signatures (to reach the quorum) are available to aggregate a Mithril stake-based multi-signature into a certificate."}),"\n",(0,s.jsx)(i.p,{children:"Mithril certificates certify some chain data using an aggregated multi-signature verification key and are chained up to some genesis certificate, which is signed by a genesis signing key."}),"\n",(0,s.jsx)(i.p,{children:"Mithril clients do connect to an aggregator using HTTP over TLS to query Mithril certificates for certified chain data and locate artifacts."}),"\n",(0,s.jsxs)(i.p,{children:["A Mithril client can verify the received Mithril certificate is linked to other certificates up to the genesis certificate and can be verified using the Mithril genesis verification key (see ",(0,s.jsx)(i.a,{href:"https://mithril.network/doc/mithril/mithril-protocol/certificates/",children:"details"}),")."]}),"\n",(0,s.jsx)(i.admonition,{title:"To do",type:"info",children:(0,s.jsx)(i.p,{children:"Missing: the currently recommended relay (reverse proxy)"})}),"\n",(0,s.jsx)(i.h4,{id:"deployment-architecture",children:"Deployment architecture"}),"\n",(0,s.jsx)(i.p,{children:"This document focuses on the standard deployment architecture, where a Mithril signer runs alongside the block-producing node, and the aggregator is accessed only through a relay."}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(95009).A+"",children:(0,s.jsx)(i.img,{alt:"Mithril - Architecture",src:n(28349).A+"",width:"1635",height:"1341"})})}),"\n",(0,s.jsx)(i.p,{children:"Additional information is available in:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://mithril.network/doc/mithril/mithril-network/architecture",children:"Mithril network architecture"})}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"https://mithril.network/doc/manual/getting-started/run-signer-node",children:"Run a Mithril signer as a stake pool operator (SPO)"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"external-dependencies",children:"External dependencies"}),"\n",(0,s.jsxs)(i.p,{children:["Below is an example of listing dependencies for the ",(0,s.jsx)(i.code,{children:"mithril-signer"})," component:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"% cargo-deps-list -e normal -p mithril-signer\n...\nslog-json v2.6.1 {default}\nslog-scope v4.4.0\narc-swap v1.6.0\n\nTotal dependencies: 267\n"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["SPO infrastructure:","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Block-producing host configuration"}),"\n",(0,s.jsx)(i.li,{children:"Relay hosts configuration"}),"\n",(0,s.jsx)(i.li,{children:"Firewall/private network."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"entry-points",children:"Entry points"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"mithril-aggregator"})," HTTP port"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"mithril-relay"})," HTTP port."]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"assumptions",children:"Assumptions"}),"\n",(0,s.jsx)(i.p,{children:"The core Mithril protocol is considered safe, and its analysis is out of scope for this document. It is computationally infeasible to:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Forge a valid aggregate signature from forged signing keys"}),"\n",(0,s.jsx)(i.li,{children:"Forge individual signatures to impersonate a legitimate signer."}),"\n"]}),"\n",(0,s.jsxs)(i.p,{children:["More information about the core Mithril protocol and its security is available in the ",(0,s.jsx)(i.a,{href:"https://iohk.io/en/research/library/papers/mithril-stake-based-threshold-multisignatures/",children:"research paper"}),"."]}),"\n",(0,s.jsx)(i.h2,{id:"assets",children:"Assets"}),"\n",(0,s.jsxs)(i.p,{children:["For each asset, we first identify which part of the ",(0,s.jsx)(i.strong,{children:"CIA triad"})," (Confidentiality, Integrity, Availability) it requires. An asset may be a resource, a piece of data (for example, keys), or a process that may be affected. We then identify threats and possible countermeasures."]}),"\n",(0,s.jsx)(i.h4,{id:"kes-private-keys",children:"KES private keys"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["The KES key is present only on the block-producing (BP) node but needs to be shared with both the ",(0,s.jsx)(i.code,{children:"cardano-node"})," process and the ",(0,s.jsx)(i.code,{children:"mithril-signer"})," process."]}),"\n",(0,s.jsxs)(i.li,{children:["KES keys are needed by ",(0,s.jsx)(i.code,{children:"mithril-signer"})," to sign a verification key along with an operational certificate that authenticates the key for this stake pool ID."]}),"\n",(0,s.jsxs)(i.li,{children:["This signing happens at every epoch.","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": Yes",(0,s.jsx)(i.br,{}),"\n","Capturing KES private keys allows an attacker to impersonate a registered SPO on-chain and produce blocks on its behalf until the keys are rotated."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes",(0,s.jsx)(i.br,{}),"\n","Rotating a compromised KES key is a time-consuming process that can be carried out even if the associated KES period has not fully passed. See ",(0,s.jsx)(i.a,{href:"https://github.com/input-output-hk/cardano-node-wiki/blob/main/docs/stake-pool-operations/7_KES_period.md",children:"KES period docs"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes",(0,s.jsx)(i.br,{}),"\n","If the KES key is unavailable, signing cannot proceed."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"block-diffusion",children:"Block diffusion"}),"\n",(0,s.jsx)(i.p,{children:"Block diffusion ensures the timely propagation of blocks that are produced locally or received from upstream peers."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No (block diffusion happens openly on the network)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (partially \u2014 if data is corrupted in transit, it can affect network consistency)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (failure to diffuse blocks harms a block producer\u2019s economic viability and can disrupt the network)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"block-production",children:"Block production"}),"\n",(0,s.jsxs)(i.p,{children:["Block production is the process of minting new blocks by block producers, using a stake-based random lottery. The ",(0,s.jsx)(i.code,{children:"mithril-signer"})," must run on the same host as a block producer, as it requires access to the KES signing key."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": Yes?",(0,s.jsx)(i.br,{}),"\n","A block producer\u2019s schedule is private information; if leaked, adversaries might carry out ",(0,s.jsx)(i.strong,{children:"grinding attacks"})," to manipulate the nonce to the producer\u2019s disadvantage."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes",(0,s.jsx)(i.br,{}),"\n","Incorrect or invalid data can hamper block production."]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes",(0,s.jsx)(i.br,{}),"\n","Block production is critical for SPO revenue; preventing a producer from creating blocks can harm the SPO\u2019s operational capabilities."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"cardano-chain-database",children:"Cardano chain database"}),"\n",(0,s.jsxs)(i.p,{children:["A ",(0,s.jsx)(i.code,{children:"cardano-node"})," maintains an on-disk database containing the chain\u2019s history. This database is updated by the node when new blocks are diffused across the network or minted, and it contains a cache of the ledger state."]}),"\n",(0,s.jsxs)(i.p,{children:["The ",(0,s.jsx)(i.code,{children:"mithril-signer"})," needs access to a ",(0,s.jsx)(i.em,{children:"trusted"})," and ",(0,s.jsx)(i.em,{children:"current"})," chain database to sign snapshots."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No (block data is publicly replicated)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"cardano-ledger-state",children:"Cardano ledger state"}),"\n",(0,s.jsxs)(i.p,{children:["The Mihril signer requires access to an accurate ledger state is needed by the ",(0,s.jsx)(i.code,{children:"mithril-signer"})," to retrieve a reliable ",(0,s.jsx)(i.em,{children:"stake distribution"}),". This currently involves a local connection (direct with Pallas or indirect with ",(0,s.jsx)(i.code,{children:"cardano-cli"}),") to a trusted ",(0,s.jsx)(i.code,{children:"cardano-node"}),". The ledger state and stake distribution are also used by the node to determine leader schedules, meaning any corruption here affects block production."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (same, inaccurate SD will make key registration and signing process invalid)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (without SD, signer cannot register keys nor validly use other signers' keys)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-signing-keys",children:"Mithril signing keys"}),"\n",(0,s.jsx)(i.p,{children:"SPOs generate their Mithril signing keys for each epoch to sign snapshots. If attackers obtain these keys, they can impersonate the SPO and produce invalid snapshots. Currently, the signing keys are stored temporarily on disk; they are used for two epochs after creation and are deleted two epochs later. Additionally, these keys are not encrypted."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": Yes (compromise allows an attacker to impersonate the signer)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (an invalid key is useless)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (the signer needs the key at every signing round; unavailability prevents signing)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-signers-registration",children:"Mithril signers registration"}),"\n",(0,s.jsxs)(i.p,{children:["A ",(0,s.jsx)(i.code,{children:"mithril-signer"})," must register a new verification key each epoch with the aggregator (and ultimately other signers)."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No (only public verification keys and proofs of possession are exchanged)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (the key registration must be correct and timely for a given epoch)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (the signer needs aggregator access to register its key)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-signature-diffusion",children:"Mithril signature diffusion"}),"\n",(0,s.jsxs)(i.p,{children:["Mithril signers produce signatures for new immutable files or other relevant data in the chain database. These signatures are derived from a random lottery based on the signer\u2019s stake and protocol parameters.",(0,s.jsx)(i.br,{}),"\n","Preventing signers from submitting signatures reduces the overall number of signatures, which could allow an attacker a greater influence over snapshot production."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": No (signatures are effectively tamper-proof)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-protocol-parameters",children:"Mithril protocol parameters"}),"\n",(0,s.jsx)(i.p,{children:"Protocol parameters coordinate valid multi-signature production and are served by the aggregator."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No (these parameters must be public)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (tampering with them could lead to invalid signatures)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-genesis-signing-key",children:"Mithril genesis signing key"}),"\n",(0,s.jsx)(i.p,{children:"The genesis signing key is stored in IOG\u2019s VaultWarden and used only once to generate the genesis certificate."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": Yes"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (?)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": No (not needed unless a re-genesis process is required; a new key could be used in that case)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"era-configuration-files",children:"Era configuration files"}),"\n",(0,s.jsxs)(i.p,{children:["The ",(0,s.jsx)(i.a,{href:"https://mithril.network/doc/adr/4",children:"Mithril network upgrade strategy"})," describes how Mithril eras activate features on all nodes at specific epoch boundaries."]}),"\n",(0,s.jsxs)(i.p,{children:["An era address is used by signers to identify the current Mithril era, which defines the structure of snapshots and signatures. It is stored in ",(0,s.jsx)(i.a,{href:"https://raw.githubusercontent.com/input-output-hk/mithril/main/mithril-infra/configuration/release-mainnet/era.addr",children:"GitHub"})," and is only modifiable via a merged PR."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No (these are public files)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (tampering could disrupt multi-signature generation)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"era-activation",children:"Era activation"}),"\n",(0,s.jsxs)(i.p,{children:["The current and next (if any) eras are announced on-chain with an era activation marker. (See ",(0,s.jsx)(i.a,{href:"https://mithril.network/doc/adr/4#era-activation-marker",children:"ADR"}),".)"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No (public)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (tampering with the marker could break multi-signature generation)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (the marker is on-chain)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"era-verification-key",children:"Era verification key"}),"\n",(0,s.jsxs)(i.p,{children:["The era verification key is in ",(0,s.jsx)(i.a,{href:"https://raw.githubusercontent.com/input-output-hk/mithril/main/mithril-infra/configuration/release-mainnet/era.vkey",children:"GitHub"})," and is only modifiable through a merged PR."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": No (the protocol enforces integrity checks)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (needed to verify the certificate chain)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"era-signing-key",children:"Era signing key"}),"\n",(0,s.jsx)(i.p,{children:"This key is stored in IOG\u2019s VaultWarden and used only when a new era is announced or activated."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": Yes"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": Yes (?)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": No."]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"client-side-only-assets",children:"Client-side only assets"}),"\n",(0,s.jsx)(i.p,{children:"These assets matter only when downloading and verifying certificates and artifacts (for example, snapshots)."}),"\n",(0,s.jsx)(i.h4,{id:"mithril-certificate-verification-process",children:"Mithril certificate verification process"}),"\n",(0,s.jsxs)(i.p,{children:["Mithril clients, such as a CLI tool or the ",(0,s.jsx)(i.a,{href:"https://mithril.network/explorer/",children:"web-based explorer"}),", download snapshots and verify their certificates using the ",(0,s.jsx)(i.code,{children:"mithril-client"})," library."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": No (snapshots and certificates are assumed to be secure by protocol design)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (?)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-certificates",children:"Mithril certificates"}),"\n",(0,s.jsx)(i.p,{children:"These are produced by the aggregator from individual signatures. Their security depends on a chain of trust that ultimately references a genesis certificate."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": No (the protocol design ensures integrity)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": No (certificates are a fallback; a Cardano node client can retrieve data from the network, albeit more slowly)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-artifacts",children:"Mithril artifacts"}),"\n",(0,s.jsx)(i.p,{children:"Mithril artifacts are generated by the aggregator for specific data types (for example, a compressed snapshot of a Cardano node database). The aggregator hosts these artifacts for client retrieval."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": No (they are verified against their certificate)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": No (a fallback exists via the original Cardano network)."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"mithril-genesis-verification-key",children:"Mithril genesis verification key"}),"\n",(0,s.jsxs)(i.p,{children:["The genesis verification key is stored in ",(0,s.jsx)(i.a,{href:"https://github.com/input-output-hk/mithril/blob/main/mithril-infra/configuration/release-mainnet/genesis.vkey",children:"GitHub"})," and is only modifiable through an approved PR."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Confidentiality"}),": No"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Integrity"}),": No (the protocol enforces integrity)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Availability"}),": Yes (needed to verify the entire certificate chain)."]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"threats-and-mitigations",children:"Threats and mitigations"}),"\n",(0,s.jsx)(i.admonition,{type:"info",children:(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"This list of threats and mitigations is not exhaustive."}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"https://developers.cardano.org/docs/operate-a-stake-pool/hardening-server",children:"Developer Portal"})," already provides thorough documentation on hardening a Linux-based host to run ",(0,s.jsx)(i.code,{children:"cardano-node"}),"."]}),"\n"]})}),"\n",(0,s.jsx)(i.h3,{id:"resource-exhaustion-on-cardano-relay",children:"Resource exhaustion on Cardano relay"}),"\n",(0,s.jsxs)(i.p,{children:["A denial-of-service (DoS) attack targeting a ",(0,s.jsx)(i.code,{children:"mithril-signer"})," running alongside a ",(0,s.jsx)(i.code,{children:"cardano-node"})," acting as a relay."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Assets at risk"}),":","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"#block-diffusion",children:"Block diffusion"})}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"#mithril-signatures-diffusion",children:"Mithril signatures diffusion"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"block-diffusion-exhaustion",children:"Block diffusion exhaustion"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Diffusion is ensured through the connection between BPs, local relays, and downstream/upstream relays"}),"\n",(0,s.jsx)(i.li,{children:"Preventing them from operating can harm the Cardano network"}),"\n",(0,s.jsx)(i.li,{children:"Relay hosts connect the BP to the network"}),"\n",(0,s.jsx)(i.li,{children:"Starving relay hosts prevents Mithril signatures and key registration from being shared"}),"\n",(0,s.jsxs)(i.li,{children:["Starving a ",(0,s.jsx)(i.code,{children:"cardano-node"})," running on a relay host would prevent or delay the diffusion of new blocks, thus harming"]}),"\n",(0,s.jsx)(i.li,{children:"Compromising relay hosts would be an extreme form of starving resources."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"resource-exhaustion-on-cardano-block-producer",children:"Resource exhaustion on Cardano block producer"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Assets at risk:","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"#block-production",children:"Block production"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"block-production-exhaustion",children:"Block production exhaustion"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["A malfunctioning or malicious ",(0,s.jsx)(i.code,{children:"mithril-signer"})," could starve a ",(0,s.jsx)(i.code,{children:"cardano-node"})," of resources, preventing it from producing and diffusing blocks in time"]}),"\n",(0,s.jsx)(i.li,{children:"Compromising a block-producing node severely harms an SPO\u2019s economic viability."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"resource-exhaustion-on-mithril-aggregator",children:"Resource exhaustion on Mithril aggregator"}),"\n",(0,s.jsxs)(i.p,{children:["A DoS on the ",(0,s.jsx)(i.code,{children:"mithril-aggregator"}),"."]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Assets at risk"}),":","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"#mithril-signers-registration",children:"Mithril signers registration"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"#mithril-signatures-diffusion",children:"Mithril signatures diffusion"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"#mithril-certificates",children:"Mithril certificates"})}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"#mithril-artifacts",children:"Mithril artifacts"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"integrity-of-the-cardano-block-producer-database",children:"Integrity of the Cardano block producer database"}),"\n",(0,s.jsx)(i.p,{children:"Data integrity of the Cardano block producer\u2019s on-disk database could be compromised either by the action of the Mithril signer or by an attacker with access to the signer."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Assets at risk"}),":"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"#block-production",children:"Block production"})}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"#cardano-chain-database",children:"Cardano chain database"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Mitigation"}),": assign the Mithril signer only ",(0,s.jsx)(i.em,{children:"read-only"})," permissions to the Cardano block producer\u2019s database folder."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://developers.cardano.org/docs/operate-a-stake-pool/",children:"SPO guide"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://mithril.network/doc/mithril/mithril-network/architecture",children:"Mithril network architecture"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://mithril.network/doc/manual/getting-started/run-signer-node",children:"Run a Mithril signer as an SPO"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://iohk.io/en/research/library/papers/mithril-stake-based-threshold-multisignatures/",children:"Mithril: Stake-based Threshold Multisignatures"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://mithril.network/doc/adr/4",children:"Mithril network upgrade strategy"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://owasp.org/www-community/Threat_Modeling_Process",children:"OWASP threat modeling process"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://github.com/lnbook/lnbook/blob/develop/16_security_privacy_ln.asciidoc",children:"Lightning book security chapter"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://github.com/lnbook/lnbook/blob/develop/11_gossip_channel_graph.asciidoc",children:"Lightning gossip protocol"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://developer.hashicorp.com/consul/docs/security/security-models/core",children:"Consul security model"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://parallaxsecond.github.io/parsec-book/parsec_security/parsec_threat_model/threat_model.html",children:"Parsec threat model"})}),"\n",(0,s.jsxs)(i.li,{children:["A list of ",(0,s.jsx)(i.a,{href:"https://github.com/hysnsec/awesome-threat-modelling#threat-model-examples",children:"threat models"})]}),"\n",(0,s.jsxs)(i.li,{children:["There is even a ",(0,s.jsx)(i.a,{href:"https://www.threatmodelingmanifesto.org",children:"threat model manifesto"})," ","\ud83d\ude2e"," !"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},95009:(e,i,n)=>{n.d(i,{A:()=>r});const r=n.p+"assets/files/architecture-e6fad1720a863c9a3986400cb5ac1287.svg"},28349:(e,i,n)=>{n.d(i,{A:()=>r});const r=n.p+"assets/images/architecture-e6fad1720a863c9a3986400cb5ac1287.svg"},28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>l});var r=n(96540);const s={},t=r.createContext(s);function a(e){const i=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:i},e.children)}}}]);