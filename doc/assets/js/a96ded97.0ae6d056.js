"use strict";(self.webpackChunkmithril_doc=self.webpackChunkmithril_doc||[]).push([[160],{89161:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var a=i(95390),t=i(74848),l=i(28453);const r={title:"Breaking changes in client library and CLI",authors:[{name:"Mithril Team"}],tags:["mithril client","library","cli","breaking-change","Cardano database","ancillary"]},s=void 0,o={authorsImageUrls:[void 0]},c=[{value:"Breaking changes in client library and CLI",id:"breaking-changes-in-client-library-and-cli",level:3},{value:"Client CLI",id:"client-cli",level:4},{value:"Client Library",id:"client-library",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"breaking-changes-in-client-library-and-cli",children:"Breaking changes in client library and CLI"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://github.com/input-output-hk/mithril/releases/tag/2517.1",children:(0,t.jsx)(n.code,{children:"2517"})})," release introduces breaking changes to the ",(0,t.jsx)(n.strong,{children:"Mithril client CLI"})," and ",(0,t.jsx)(n.strong,{children:"library"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"client-cli",children:"Client CLI"}),"\n",(0,t.jsxs)(n.p,{children:["The command for downloading a certified Cardano database using the ",(0,t.jsx)(n.strong,{children:"Mithril client CLI"})," has been updated starting from version ",(0,t.jsx)(n.code,{children:"0.12.1"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The existing command remains functional but no longer downloads ancillary files (ledger state snapshot and last immutable file) by default. As a result, the fast bootstrap feature is disabled, requiring the Cardano node to compute the ledger state from the genesis block during startup:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mithril-client cardano-database download latest\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["To include ancillary files and enable fast bootstrap, use the new command with the ",(0,t.jsx)(n.code,{children:"--include-ancillary"})," option:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mithril-client cardano-database download latest --include-ancillary --ancillary-verification-key <ANCILLARY_VERIFICATION_KEY>\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The new command requires an ",(0,t.jsx)(n.strong,{children:"ancillary verification key"}),". This key can be provided via the ",(0,t.jsx)(n.code,{children:"--ancillary-verification-key"})," option or the ",(0,t.jsx)(n.code,{children:"ANCILLARY_VERIFICATION_KEY"})," environment variable. Details are available on the ",(0,t.jsx)(n.a,{href:"https://mithril.network/doc/next/manual/getting-started/network-configurations",children:"Networks configuration"})," page."]})}),"\n",(0,t.jsxs)(n.p,{children:["To update the Mithril client CLI, use the following one-line command. By default, it downloads to the current directory. To specify a custom folder, use the ",(0,t.jsx)(n.code,{children:"-p"})," option:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl --proto '=https' --tlsv1.2 -sSf https://raw.githubusercontent.com/input-output-hk/mithril/refs/heads/main/mithril-install.sh | sh -s -- -c mithril-client -d 2517.1 -p $(pwd)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For more details, refer to the ",(0,t.jsx)(n.a,{href:"https://mithril.network/doc/manual/develop/nodes/mithril-client",children:"Mithril client node"})," documentation."]}),"\n",(0,t.jsx)(n.h4,{id:"client-library",children:"Client Library"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"Mithril client library"})," has also been updated. By default, it no longer downloads ancillary files (ledger state snapshot and last immutable file), which disables the fast bootstrap feature. Consequently, the Cardano node must compute the ledger state from the genesis block during startup."]}),"\n",(0,t.jsxs)(n.p,{children:["To enable fast bootstrap, use the ",(0,t.jsx)(n.code,{children:"download_unpack_full"})," function instead of ",(0,t.jsx)(n.code,{children:"download_unpack"})," and provide the ",(0,t.jsx)(n.code,{children:"set_ancillary_verification_key"})," parameter:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Set the ancillary verification key using the ",(0,t.jsx)(n.code,{children:"set_ancillary_verification_key"})," method when building the client:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:'let client = ClientBuilder::aggregator(AGGREGATOR_ENDPOINT, GENESIS_VERIFICATION_KEY)\n    .set_ancillary_verification_key(ANCILLARY_VERIFICATION_KEY.to_string()) // Added line\n    .with_origin_tag(Some("EXAMPLE".to_string()))\n    .build()?;\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"ancillary verification key"})," for the Mithril networks are available on the ",(0,t.jsx)(n.a,{href:"https://mithril.network/doc/next/manual/getting-started/network-configurations",children:"Networks configuration"})," page."]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use the ",(0,t.jsx)(n.code,{children:"download_unpack_full"})," function to download ancillary files:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",children:"client\n    .cardano_database()\n    .download_unpack_full(&snapshot, target_directory)\n    .await?;\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For more information and a complete example, refer to the ",(0,t.jsx)(n.a,{href:"https://mithril.network/doc/manual/develop/nodes/mithril-client-library#cardano-database",children:"Mithril client library"})," documentation."]}),"\n",(0,t.jsxs)(n.p,{children:["If you have any questions or need assistance, contact the team on the ",(0,t.jsx)(n.a,{href:"https://discord.gg/5kaErDKDRq",children:"Discord channel"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>s});var a=i(96540);const t={},l=a.createContext(t);function r(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(l.Provider,{value:n},e.children)}},95390:e=>{e.exports=JSON.parse('{"permalink":"/doc/dev-blog/2025/05/06/client-breaking-change","source":"@site/blog/2025-05-06-client-breaking-change.md","title":"Breaking changes in client library and CLI","description":"Breaking changes in client library and CLI","date":"2025-05-06T00:00:00.000Z","tags":[{"inline":true,"label":"mithril client","permalink":"/doc/dev-blog/tags/mithril-client"},{"inline":true,"label":"library","permalink":"/doc/dev-blog/tags/library"},{"inline":true,"label":"cli","permalink":"/doc/dev-blog/tags/cli"},{"inline":true,"label":"breaking-change","permalink":"/doc/dev-blog/tags/breaking-change"},{"inline":true,"label":"Cardano database","permalink":"/doc/dev-blog/tags/cardano-database"},{"inline":true,"label":"ancillary","permalink":"/doc/dev-blog/tags/ancillary"}],"readingTime":2.11,"hasTruncateMarker":false,"authors":[{"name":"Mithril Team","socials":{},"key":null,"page":null}],"frontMatter":{"title":"Breaking changes in client library and CLI","authors":[{"name":"Mithril Team"}],"tags":["mithril client","library","cli","breaking-change","Cardano database","ancillary"]},"unlisted":false,"prevItem":{"title":"Mithril Cardano database snapshots security advisory","permalink":"/doc/dev-blog/2025/05/07/client-security-advisory"},"nextItem":{"title":"Distribution `2517` is now available","permalink":"/doc/dev-blog/2025/05/05/distribution-2517"}}')}}]);