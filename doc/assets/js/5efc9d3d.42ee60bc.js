"use strict";(globalThis.webpackChunkmithril_doc=globalThis.webpackChunkmithril_doc||[]).push([[2422,5473],{3393(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"compiled-binaries","title":"compiled-binaries","description":"You can install a the latest released binary of the {props.node} by running this one line command (replace **YOURPATH with your installation path_):","source":"@site/root/compiled-binaries.mdx","sourceDirName":".","slug":"/compiled-binaries","permalink":"/doc/next/compiled-binaries","draft":false,"unlisted":true,"editUrl":"https://github.com/input-output-hk/mithril/edit/main/docs/website/root/compiled-binaries.mdx","tags":[],"version":"current","frontMatter":{"unlisted":true,"hide_title":true,"hide_table_of_contents":true}}');var a=t(74848),r=t(28453),o=t(83457);const s={unlisted:!0,hide_title:!0,hide_table_of_contents:!0},l=void 0,d={},c=[];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["You can install a the ",(0,a.jsx)(n.strong,{children:"latest"})," released binary of the ",(0,a.jsx)(n.strong,{children:e.node})," by running this one line command (",(0,a.jsxs)(n.em,{children:["replace ",(0,a.jsx)(n.strong,{children:"YOUR_PATH"})," with your installation path"]}),"):"]}),"\n",(0,a.jsx)(o.A,{language:"bash",children:(0,a.jsxs)(n.p,{children:["curl --proto '=https' --tlsv1.2 -sSf\n",(0,a.jsx)(n.a,{href:"https://raw.githubusercontent.com/input-output-hk/mithril/refs/heads/main/mithril-install.sh",children:"https://raw.githubusercontent.com/input-output-hk/mithril/refs/heads/main/mithril-install.sh"}),"\n| sh -s -- -c ",e.node," -d latest -p ",(0,a.jsx)(n.strong,{children:"YOUR_PATH"})]})}),"\n",(0,a.jsxs)(n.admonition,{type:"tip",children:[(0,a.jsxs)(n.p,{children:["You can also install the ",(0,a.jsx)(n.strong,{children:e.node})," binary for other distributions:"]}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["use ",(0,a.jsx)(n.code,{children:"-d unstable"})," for the ",(0,a.jsx)(n.strong,{children:"unstable"})," version"]}),"\n",(0,a.jsxs)(n.li,{children:["use ",(0,a.jsx)(n.code,{children:"-d **DISTRIBUTION_VERSION**"})," for a specific distribution (e.g. ",(0,a.jsx)(n.code,{children:"-d 2445.0"}),")"]}),"\n"]})]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["The Linux binaries target ",(0,a.jsx)(n.code,{children:"glibc"}),", and have a minimum requirement of ",(0,a.jsx)(n.code,{children:"glibc 2.35"})," (compatible with ",(0,a.jsx)(n.code,{children:"Ubuntu 22.04"}),"\nor ",(0,a.jsx)(n.code,{children:"Debian 12 - Bookworm"}),")."]})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},55244(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"manual/getting-started/bootstrap-cardano-node","title":"Bootstrap a Cardano node","description":"With the Mithril client connected to a Mithril aggregator, you can restore a full Cardano node on the mainnet in less than 20 minutes!","source":"@site/root/manual/getting-started/bootstrap-cardano-node.md","sourceDirName":"manual/getting-started","slug":"/manual/getting-started/bootstrap-cardano-node","permalink":"/doc/next/manual/getting-started/bootstrap-cardano-node","draft":false,"unlisted":false,"editUrl":"https://github.com/input-output-hk/mithril/edit/main/docs/website/root/manual/getting-started/bootstrap-cardano-node.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"manualSideBar","previous":{"title":"Network configurations","permalink":"/doc/next/manual/getting-started/network-configurations"},"next":{"title":"Operate","permalink":"/doc/next/manual/operate/"}}');var a=t(74848),r=t(28453),o=t(3393);const s={sidebar_position:3},l="Bootstrap a Cardano node",d={},c=[{value:"Set up the environment",id:"set-up-the-environment",level:2},{value:"Download the source file",id:"download-the-source-file",level:2},{value:"Build the Mithril client binary",id:"build-the-mithril-client-binary",level:2},{value:"Verify the binary",id:"verify-the-binary",level:2},{value:"Verify the version",id:"verify-the-version",level:3},{value:"Verify the build",id:"verify-the-build",level:3},{value:"Download the pre-built binary",id:"download-the-pre-built-binary",level:2},...o.toc,{value:"Run the Docker container",id:"run-the-docker-container",level:2},{value:"MSYS2 Windows build",id:"msys2-windows-build",level:2},{value:"Bootstrap a Cardano node from a testnet Mithril Cardano DB snapshot",id:"bootstrap-a-cardano-node-from-a-testnet-mithril-cardano-db-snapshot",level:2},{value:"Step 1: Prepare some useful variables",id:"step-1-prepare-some-useful-variables",level:3},{value:"Step 2: Select a Cardano DB snapshot",id:"step-2-select-a-cardano-db-snapshot",level:3},{value:"Step 3: Show Cardano DB snapshot details",id:"step-3-show-cardano-db-snapshot-details",level:3},{value:"Step 4: Download the selected Cardano DB snapshot",id:"step-4-download-the-selected-cardano-db-snapshot",level:3},{value:"Step 5 (optional): Convert the ledger state snapshot to another flavor",id:"step-5-optional-convert-the-ledger-state-snapshot-to-another-flavor",level:3},{value:"Step 6: Launch a Cardano node from the restored Cardano DB snapshot",id:"step-6-launch-a-cardano-node-from-the-restored-cardano-db-snapshot",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"bootstrap-a-cardano-node",children:"Bootstrap a Cardano node"})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["With the ",(0,a.jsx)(n.strong,{children:"Mithril client"})," connected to a ",(0,a.jsx)(n.strong,{children:"Mithril aggregator"}),", you can restore a full Cardano node on the ",(0,a.jsx)(n.code,{children:"mainnet"})," in less than ",(0,a.jsx)(n.strong,{children:"20 minutes"}),"!"]})}),"\n",(0,a.jsx)(n.h2,{id:"set-up-the-environment",children:"Set up the environment"}),"\n",(0,a.jsx)(n.p,{children:"Before proceeding with the installation, ensure that you have the following prerequisites in place:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsxs)(n.strong,{children:["Install a ",(0,a.jsx)(n.a,{href:"https://www.rust-lang.org/learn/get-started",children:"correctly configured"})," Rust toolchain"]}),": make sure you have the latest stable version of Rust installed."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsxs)(n.strong,{children:["Install build tools ",(0,a.jsx)(n.code,{children:"build-essential"})," and ",(0,a.jsx)(n.code,{children:"m4"})]}),": on Ubuntu/Debian/Mint, run ",(0,a.jsx)(n.code,{children:"sudo apt install build-essential m4"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Install OpenSSL development libraries"}),": on Ubuntu/Debian/Mint, run the following command to install the required OpenSSL development libraries:"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"sudo apt install libssl-dev\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Install other requirements"}),": make sure you have all the additional dependencies and requirements specified for the project:"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install make build-essential m4 docker jq\n"})}),"\n",(0,a.jsx)(n.h2,{id:"download-the-source-file",children:"Download the source file"}),"\n",(0,a.jsx)(n.p,{children:"You can download the source file from GitHub (HTTPS):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/input-output-hk/mithril.git\n"})}),"\n",(0,a.jsx)(n.p,{children:"Or (SSH):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"git clone git@github.com:input-output-hk/mithril.git\n"})}),"\n",(0,a.jsx)(n.h2,{id:"build-the-mithril-client-binary",children:"Build the Mithril client binary"}),"\n",(0,a.jsx)(n.p,{children:"To build the Mithril client binary, switch to the desired branch/tag:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Replace **YOUR_BUILD_BRANCH_OR_TAG** with the appropriate branch or tag name\n# Please refer to the [**Network configurations**](http://mithril.network/manual/getting-started/network-configurations) section of the user manual\ngit checkout **YOUR_BUILD_BRANCH_OR_TAG**\n"})}),"\n",(0,a.jsx)(n.p,{children:"Change the directory:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd mithril/mithril-client-cli\n"})}),"\n",(0,a.jsx)(n.p,{children:"Run tests (optional):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"make test\n"})}),"\n",(0,a.jsx)(n.p,{children:"Build the executable:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"make build\n"})}),"\n",(0,a.jsx)(n.h2,{id:"verify-the-binary",children:"Verify the binary"}),"\n",(0,a.jsx)(n.h3,{id:"verify-the-version",children:"Verify the version"}),"\n",(0,a.jsx)(n.p,{children:"To check if the version of the Mithril signer binary is correct, use the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./mithril-client -V\n"})}),"\n",(0,a.jsx)(n.p,{children:"You should see something like:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mithril-client 0.7.6\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u26a0\ufe0f"," Verify that the version displayed corresponds to the version specified in the content of the release/pre-release notes (refer to the ",(0,a.jsx)(n.strong,{children:"Build from"})," column in the 'Mithril networks' section)."]}),"\n",(0,a.jsx)(n.h3,{id:"verify-the-build",children:"Verify the build"}),"\n",(0,a.jsx)(n.p,{children:"To verify that the Mithril client binary is functioning correctly, run the following command to display its help menu:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./mithril-client -h\n"})}),"\n",(0,a.jsx)(n.p,{children:"You should see:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'This program shows, downloads and verifies certified blockchain artifacts.\n\nUsage: mithril-client [OPTIONS] <COMMAND>\n\nCommands:\n  cardano-db                  Cardano db management (alias: cdb)\n  mithril-stake-distribution  Mithril stake distribution management (alias: msd)\n  cardano-transaction         Cardano transactions management (alias: ctx)\n  cardano-stake-distribution  Cardano stake distribution management (alias: csd)\n  tools                       Tools commands\n  help                        Print this message or the help of the given subcommand(s)\n\nOptions:\n      --run-mode <RUN_MODE>\n          Run Mode\n\n          [env: RUN_MODE=]\n          [default: dev]\n\n  -v, --verbose...\n          Verbosity level (-v=warning, -vv=info, -vvv=debug, -vvvv=trace)\n\n      --config-directory <CONFIG_DIRECTORY>\n          Directory where configuration file is located\n\n          [default: ./config]\n\n      --aggregator-endpoint <AGGREGATOR_ENDPOINT>\n          Override configuration Aggregator endpoint URL.\n\n          Either the full URL of the aggregator endpoint (e.g., "https://aggregator.release-preprod.api.mithril.network/aggregator") or a string formatted as "auto:<mithril_network>" to use automatic discovery (e.g., "auto:release-preprod") (unstable).\n\n          [env: AGGREGATOR_ENDPOINT=]\n\n      --json\n          Enable JSON output for command results\n\n      --log-format-json\n          Enable JSON output for logs displayed according to verbosity level\n\n      --log-output <LOG_OUTPUT>\n          Redirect the logs to a file\n\n      --unstable\n          Enable unstable commands\n\n      --origin-tag <ORIGIN_TAG>\n          Request origin tag\n\n      --era <ERA>\n          Override the Mithril era\n\n  -h, --help\n          Print help (see a summary with \'-h\')\n\n  -V, --version\n          Print version\n'})}),"\n",(0,a.jsxs)(n.admonition,{type:"tip",children:[(0,a.jsxs)(n.p,{children:["To display results in JSON format for the ",(0,a.jsx)(n.code,{children:"list"})," and ",(0,a.jsx)(n.code,{children:"show"})," commands of the Mithril client, you can use the ",(0,a.jsx)(n.code,{children:"--json"})," option:"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./mithril-client cardano-db snapshot list --json\n"})})]}),"\n",(0,a.jsxs)(n.admonition,{type:"tip",children:[(0,a.jsx)(n.p,{children:"If you wish to delve deeper and access several levels of logs from the Mithril client, you can use the following:"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Add ",(0,a.jsx)(n.code,{children:"-v"})," for some logs (WARN)"]}),"\n",(0,a.jsxs)(n.li,{children:["Add ",(0,a.jsx)(n.code,{children:"-vv"})," for more logs (INFO)"]}),"\n",(0,a.jsxs)(n.li,{children:["Add ",(0,a.jsx)(n.code,{children:"-vvv"})," for even more logs (DEBUG)"]}),"\n",(0,a.jsxs)(n.li,{children:["Add ",(0,a.jsx)(n.code,{children:"-vvvv"})," for all logs (TRACE)."]}),"\n"]})]}),"\n",(0,a.jsx)(n.h2,{id:"download-the-pre-built-binary",children:"Download the pre-built binary"}),"\n",(0,a.jsx)(o.default,{node:"mithril-client"}),"\n",(0,a.jsx)(n.h2,{id:"run-the-docker-container",children:"Run the Docker container"}),"\n",(0,a.jsxs)(n.p,{children:["The list of available images on the registry is listed ",(0,a.jsx)(n.a,{href:"https://github.com/input-output-hk/mithril/pkgs/container/mithril-client",children:"here"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Prepare an environment variable with the selected Docker image:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"export MITHRIL_IMAGE_ID=**YOUR_MITHRIL_IMAGE_ID**\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Here is an example configuration for the ",(0,a.jsx)(n.code,{children:"latest"})," stable Docker image:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"export MITHRIL_IMAGE_ID=latest\n"})}),"\n",(0,a.jsx)(n.p,{children:"Then, create a shell function for the Mithril client:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mithril_client () {\n  docker run --rm -e GENESIS_VERIFICATION_KEY=$GENESIS_VERIFICATION_KEY -e AGGREGATOR_ENDPOINT=$AGGREGATOR_ENDPOINT --name='mithril-client' -v $(pwd):/app/data -w /app/data -u $(id -u) ghcr.io/input-output-hk/mithril-client:$MITHRIL_IMAGE_ID $@\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You can now use the ",(0,a.jsx)(n.code,{children:"mithril_client"})," function:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# 1- Help\nmithril_client help\n\n# 2- List snapshots\nmithril_client cardano-db snapshot list\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["In the following part of the document, you will need to replace the ",(0,a.jsx)(n.code,{children:"./mithril-client"})," commands with ",(0,a.jsx)(n.code,{children:"mithril_client"})," to use the above shell function."]})}),"\n",(0,a.jsx)(n.h2,{id:"msys2-windows-build",children:"MSYS2 Windows build"}),"\n",(0,a.jsxs)(n.p,{children:["To build the ",(0,a.jsx)(n.code,{children:"mithril-client"})," executable on MSYS2 (see\n",(0,a.jsx)(n.a,{href:"https://www.msys2.org/",children:"MSYS2's webpage"})," for installation instructions), the\nfollowing packages have to be installed:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pacman --noconfirm -S base-devel mingw-w64-<env>-x86_64-toolchain mingw-w64-<env>-x86_64-openssl\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Where ",(0,a.jsx)(n.code,{children:"env"})," has to be replaced with your particular\n",(0,a.jsx)(n.a,{href:"https://www.msys2.org/docs/environments/",children:"environment"})," of choice, for example,\n",(0,a.jsx)(n.code,{children:"ucrt"})," if running in the ",(0,a.jsx)(n.code,{children:"UCRT64"})," environment. Use ",(0,a.jsx)(n.code,{children:"pacman -Ss <package name>"}),"\nto search for packages if unsure."]}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.p,{children:"If you encounter the following error:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"    This perl implementation doesn't produce Unix like paths (with forward slash\n    directory separators). Please use an implementation that matches your\n    building platform.\n"})}),(0,a.jsxs)(n.p,{children:["make sure that the ",(0,a.jsx)(n.code,{children:"perl"})," in ",(0,a.jsx)(n.code,{children:"/usr/bin/perl.exe"})," (from the ",(0,a.jsx)(n.code,{children:"perl"})," package) comes\nbefore the ",(0,a.jsx)(n.code,{children:"perl"})," in ",(0,a.jsx)(n.code,{children:"/<env>/bin/perl.exe"})," (from the\n",(0,a.jsx)(n.code,{children:"mingw-w64-<env>-x86_64-perl"})," package)."]})]}),"\n",(0,a.jsxs)(n.p,{children:["From here, you have to run the ",(0,a.jsx)(n.code,{children:"rustup-init.exe"})," binary from\n",(0,a.jsx)(n.a,{href:"https://rustup.rs/",children:"rustup"})," and follow along these steps:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"Rust Visual C++ prerequisites\n\nRust requires a linker and Windows API libraries, but they don't seem to be\navailable.\n\nThese components can be acquired through a Visual Studio installer.\n\n1) Quick install via the Visual Studio Community installer\n   (free for individuals, academic uses, and open source).\n\n2) Manually install the prerequisites\n   (for enterprise and advanced users).\n\n3) Don't install the prerequisites\n   (if you're targeting the GNU ABI).\n\n>3\n\n\nWelcome to Rust!\n\nThis will download and install the official compiler for the Rust\nprogramming language, and its package manager, Cargo.\n\nRustup metadata and toolchains will be installed into the Rustup\nhome directory, located at:\n\n  C:\\Users\\<User>\\.rustup\n\nThis can be modified with the RUSTUP_HOME environment variable.\n\nThe Cargo home directory is located at:\n\n  C:\\Users\\<User>\\.cargo\n\nThis can be modified with the CARGO_HOME environment variable.\n\nThe cargo, rustc, rustup and other commands will be added to\nCargo's bin directory, located at:\n\n  C:\\Users\\<User>\\.cargo\\bin\n\nThis path will then be added to your PATH environment variable by\nmodifying the HKEY_CURRENT_USER/Environment/PATH registry key.\n\nYou can uninstall at any time with rustup self uninstall and\nthese changes will be reverted.\n\nCurrent installation options:\n\n\n   default host triple: x86_64-pc-windows-msvc\n     default toolchain: stable (default)\n               profile: default\n  modify PATH variable: yes\n\n1) Proceed with standard installation (default - just press enter)\n2) Customize installation\n3) Cancel installation\n>2\n\nI'm going to ask you about the value of each of these installation options.\nYou may simply press the Enter key to leave unchanged.\n\nDefault host triple? [x86_64-pc-windows-msvc]\nx86_64-pc-windows-gnu\n\nDefault toolchain? (stable/beta/nightly/none) [stable]\n\n\nProfile (which tools and data to install)? (minimal/default/complete) [default]\n\n\nModify PATH variable? (Y/n)\n\n\n\nCurrent installation options:\n\n\n   default host triple: x86_64-pc-windows-gnu\n     default toolchain: stable\n               profile: default\n  modify PATH variable: yes\n\n1) Proceed with selected options (default - just press enter)\n2) Customize installation\n3) Cancel installation\n>1\n"})}),"\n",(0,a.jsx)(n.p,{children:"Once the Rust toolchain is installed, one can build the executable normally:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd mithril-client-cli\nmake build\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This will produce a binary ",(0,a.jsx)(n.code,{children:"mithril-client.exe"})," on the current directory. It can\nbe invoked the same way as in Linux, with ",(0,a.jsx)(n.code,{children:"./mithril-client"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"bootstrap-a-cardano-node-from-a-testnet-mithril-cardano-db-snapshot",children:"Bootstrap a Cardano node from a testnet Mithril Cardano DB snapshot"}),"\n",(0,a.jsx)(n.h3,{id:"step-1-prepare-some-useful-variables",children:"Step 1: Prepare some useful variables"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Cardano network\nexport CARDANO_NETWORK=**YOUR_CARDANO_NETWORK**\n\n# Aggregator API endpoint URL\nexport AGGREGATOR_ENDPOINT=**YOUR_AGGREGATOR_ENDPOINT**\n\n# Genesis verification key\nexport GENESIS_VERIFICATION_KEY=$(wget -q -O - **YOUR_GENESIS_VERIFICATION_KEY**)\n\n# Ancillary verification key\nexport ANCILLARY_VERIFICATION_KEY=$(wget -q -O - **YOUR_ANCILLARY_VERIFICATION_KEY**)\n\n# Digest of the latest produced cardano db snapshot for convenience of the demo\n# You can also modify this variable and set it to the value of the digest of a snapshot that you can retrieve at step 2\nexport SNAPSHOT_DIGEST=latest\n"})}),"\n",(0,a.jsxs)(n.admonition,{type:"tip",children:[(0,a.jsx)(n.p,{children:"In the following commands, we will use the following environment variables:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Cardano network\nexport CARDANO_NETWORK=preview\n\n# Aggregator API endpoint URL\nexport AGGREGATOR_ENDPOINT=https://aggregator.pre-release-preview.api.mithril.network/aggregator\n\n# Genesis verification key\nexport GENESIS_VERIFICATION_KEY=$(wget -q -O - https://raw.githubusercontent.com/input-output-hk/mithril/main/mithril-infra/configuration/pre-release-preview/genesis.vkey)\n\n# Ancillary verification key\nexport ANCILLARY_VERIFICATION_KEY=$(wget -q -O - https://raw.githubusercontent.com/input-output-hk/mithril/main/mithril-infra/configuration/pre-release-preview/ancillary.vkey)\n\n# Digest of the latest produced cardano db snapshot for convenience of the demo\nexport SNAPSHOT_DIGEST=latest\n"})})]}),"\n",(0,a.jsx)(n.h3,{id:"step-2-select-a-cardano-db-snapshot",children:"Step 2: Select a Cardano DB snapshot"}),"\n",(0,a.jsx)(n.p,{children:"List the available Cardano db snapshots with which you can bootstrap a Cardano node:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./mithril-client cardano-db snapshot list\n"})}),"\n",(0,a.jsx)(n.p,{children:"You will see a list of snapshots:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"+-------+-----------+---------+------------------------------------------------------------------+----------+-----------+-----------------------------------+\n| Epoch | Immutable | Network | Digest                                                           |     Size | Locations |                           Created |\n+-------+-----------+---------+------------------------------------------------------------------+----------+-----------+-----------------------------------+\n| 916   | 18323     | preview | a1b5e6f43521fd9c5f55e3d6bf27dc4a62f43980681cb67e28cc40582a0d1974 | 3.14 GiB | 1         | 2025-04-28 08:40:34.353548187 UTC |\n+-------+-----------+---------+------------------------------------------------------------------+----------+-----------+-----------------------------------+\n| 916   | 18322     | preview | 1d5172a41f400a61cb7504a6f83f5c40b0f24908aa116bfe150652ccf17ae21d | 3.13 GiB | 1         | 2025-04-28 07:22:51.737425114 UTC |\n+-------+-----------+---------+------------------------------------------------------------------+----------+-----------+-----------------------------------+\n| 916   | 18321     | preview | 9cd5131547a7ee1e70bbeb2bb3172392aa4f92748664294619f9a65c41fcb6d1 | 3.13 GiB | 1         | 2025-04-28 06:26:46.276160645 UTC |\n+-------+-----------+---------+------------------------------------------------------------------+----------+-----------+-----------------------------------+\n| 916   | 18320     | preview | 550bc24850f69117e2adb6974d910bf9ec97c6ac322e6eac5d5012502e8eb05f | 3.13 GiB | 1         | 2025-04-28 05:18:16.835951479 UTC |\n+-------+-----------+---------+------------------------------------------------------------------+----------+-----------+-----------------------------------+\n\u2026\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:["If you restore a Cardano node with a version not included in the ",(0,a.jsx)(n.a,{href:"/doc/next/manual/getting-started/network-configurations",children:"advertised range of compatible versions"}),", it may take extra time due to ledger computations or even crash the node."]})}),"\n",(0,a.jsx)(n.h3,{id:"step-3-show-cardano-db-snapshot-details",children:"Step 3: Show Cardano DB snapshot details"}),"\n",(0,a.jsx)(n.p,{children:"To get more details from a specific snapshot (optional), run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./mithril-client cardano-db snapshot show $SNAPSHOT_DIGEST\n"})}),"\n",(0,a.jsx)(n.p,{children:"You will see more information about the snapshot:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Epoch                 | 916                                                                                                                                                                                                             |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Immutable File Number | 18323                                                                                                                                                                                                           |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Network               | preview                                                                                                                                                                                                         |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Digest                | a1b5e6f43521fd9c5f55e3d6bf27dc4a62f43980681cb67e28cc40582a0d1974                                                                                                                                                |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Size                  | 3.14 GiB                                                                                                                                                                                                        |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Cardano node version  | 10.6.2                                                                                                                                                                                                          |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Location              | https://storage.googleapis.com/cdn.aggregator.pre-release-preview.api.mithril.network/cardano-immutable-files-full/preview-e916-i18323.a1b5e6f43521fd9c5f55e3d6bf27dc4a62f43980681cb67e28cc40582a0d1974.tar.zst |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Created               | 2025-04-28 08:40:34.353548187 UTC                                                                                                                                                                               |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Compression Algorithm | Zstandard                                                                                                                                                                                                       |\n+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n"})}),"\n",(0,a.jsx)(n.h3,{id:"step-4-download-the-selected-cardano-db-snapshot",children:"Step 4: Download the selected Cardano DB snapshot"}),"\n",(0,a.jsx)(n.p,{children:"To download the selected snapshot from the remote location to your remote location, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"./mithril-client cardano-db download --include-ancillary $SNAPSHOT_DIGEST\n"})}),"\n",(0,a.jsxs)(n.admonition,{type:"warning",children:[(0,a.jsxs)(n.p,{children:["To enable fast boostrap, ancillary files must be downloaded by using the ",(0,a.jsx)(n.code,{children:"--include-ancillary"})," option."]}),(0,a.jsx)(n.p,{children:"Ancillary files contain files that can't be currently signed by the Mithril protocol: the last ledger state snapshot\nand the last immutable file."}),(0,a.jsxs)(n.p,{children:["For additional security, ancillary files are signed using ",(0,a.jsx)(n.code,{children:"Ed25519"})," and the signature is checked against the provided\n",(0,a.jsx)(n.code,{children:"ANCILLARY_VERIFICATION_KEY"}),"."]})]}),"\n",(0,a.jsx)(n.p,{children:"You will see that the selected snapshot archive has been downloaded locally unpacked and that the associated certificate is valid:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"1/7 - Checking local disk info\u2026\n2/7 - Fetching the certificate and verifying the certificate chain\u2026\n  Certificate chain validated\n3/7 - Downloading and unpacking the cardano db snapshot\n   [00:19:21] [###########################################################################################################] Files: 24,348/24,348 (0.0s)\n   [00:00:01] [###########################################################################################] 165.88 MiB/165.88 MiB (0.0s)\n4/7 - Downloading and verifying digests\u2026\n5/7 - Verifying the cardano database\n6/7 - Computing the cardano db snapshot message\n7/7 - Verifying the cardano db signature\nCardano database snapshot '188f65fc7d3bbf30a59ab05ce4ec6649cec96a1b51b909ca0d1702555e8605d0' archives have been successfully unpacked. Immutable files have been successfully verified with Mithril.\n\n    Files in the directory 'db' can be used to run a Cardano node with version >= 10.6.2.\n\n    If you are using the Cardano Docker image, you can restore a Cardano node with:\n\n    docker run -v cardano-node-ipc:/ipc -v cardano-node-data:/data --mount type=bind,source=\"/home/mithril/data/testnet/a1b5e6f43521fd9c5f55e3d6bf27dc4a62f43980681cb67e28cc40582a0d1974/db\",target=/data/db/ -e NETWORK=preview ghcr.io/intersectmbo/cardano-node:10.6.2\n\n\nUpgrade and replace the restored ledger state snapshot to 'LMDB' flavor by running the command:\n\n    mithril-client tools utxo-hd snapshot-converter --db-directory db --cardano-node-version 10.6.2 --utxo-hd-flavor LMDB --commit\n"})}),"\n",(0,a.jsx)(n.h3,{id:"step-5-optional-convert-the-ledger-state-snapshot-to-another-flavor",children:"Step 5 (optional): Convert the ledger state snapshot to another flavor"}),"\n",(0,a.jsxs)(n.p,{children:["After restoring a snapshot with the ",(0,a.jsx)(n.code,{children:"--include-ancillary"})," option, the ledger state is in the ",(0,a.jsx)(n.code,{children:"InMemory"})," format. You can convert it to another UTxO-HD flavor (e.g., ",(0,a.jsx)(n.code,{children:"LMDB"})," or ",(0,a.jsx)(n.code,{children:"Legacy"}),") using the Mithril client ",(0,a.jsx)(n.code,{children:"tools utxo-hd snapshot-converter"})," command."]}),"\n",(0,a.jsx)(n.p,{children:"To do so, run the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"mithril-client tools utxo-hd snapshot-converter --db-directory db --cardano-node-version latest --utxo-hd-flavor LMDB\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Or, to convert it to the ",(0,a.jsx)(n.code,{children:"Legacy"})," flavor:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"mithril-client tools utxo-hd snapshot-converter --db-directory db --cardano-node-version latest --utxo-hd-flavor Legacy\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Use the ",(0,a.jsx)(n.code,{children:"--commit"})," option to replace the current ledger state with the converted snapshot."]}),"\n",(0,a.jsxs)(n.p,{children:["You can also replace ",(0,a.jsx)(n.code,{children:"latest"})," with a specific Cardano node version tag which will be used to download the corresponding Cardano node distribution and extract the ",(0,a.jsx)(n.code,{children:"snapshot-converter"})," binary tool."]}),"\n",(0,a.jsx)(n.h3,{id:"step-6-launch-a-cardano-node-from-the-restored-cardano-db-snapshot",children:"Step 6: Launch a Cardano node from the restored Cardano DB snapshot"}),"\n",(0,a.jsx)(n.p,{children:"Launch an empty Cardano node and make it live in minutes!"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'docker run -v cardano-node-ipc:/ipc -v cardano-node-data:/data --mount type=bind,source="$(pwd)/data/testnet/$SNAPSHOT_DIGEST/db",target=/data/db/ -e NETWORK=$CARDANO_NETWORK ghcr.io/intersectmbo/cardano-node:10.6.2\n'})}),"\n",(0,a.jsx)(n.p,{children:"You will see the Cardano node start by validating the files ingested from the snapshot archive. Then, it will synchronize with the other network nodes and start adding blocks:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"[c995d1df:cardano.node.ChainDB:Notice:322] [2022-07-10 13:53:40.06 UTC] Chain extended, new tip: 7ae33b2f4bc8b84e77dfd539f0f6e7f59b293e96f62fdcfdb17cbd7a006fe5c0 at slot 63081906\n[c995d1df:cardano.node.ChainDB:Notice:322] [2022-07-10 13:55:08.30 UTC] Chain extended, new tip: 6b4ccd2bec5e3862b23ea0f7c2f342a3659cecdcfdaf04551179df3839be6213 at slot 63092090\n[c995d1df:cardano.node.ChainDB:Notice:322] [2022-07-10 13:55:21.36 UTC] Chain extended, new tip: 6e95eb82da5a38544e6ef430a2733f6014c3c10527003b9d3bdc534f6a2ce81f at slot 63092103\n[c995d1df:cardano.node.ChainDB:Notice:322] [2022-07-10 13:55:39.04 UTC] Chain extended, new tip: a662672ec4b988022e135cb0b7e440f5fbffe8e205771d13a566a418f7021ba7 at slot 63092121\n[c995d1df:cardano.node.ChainDB:Notice:322] [2022-07-10 13:55:45.18 UTC] Chain extended, new tip: 2a0f2e6f218a08f4e0bc4668285d8e792fd7ec62f05880bd5b2d23d6bce20dfb at slot 63092127\n[c995d1df:cardano.node.ChainDB:Notice:322] [2022-07-10 13:56:18.05 UTC] Chain extended, new tip: ab9ef8af92ec062ec59a10da588e238ba8840705c095ebd5cd5da7ab9ea9c8e1 at slot 63092160\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);