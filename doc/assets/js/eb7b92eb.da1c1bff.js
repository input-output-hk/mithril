"use strict";(self.webpackChunkmithril_doc=self.webpackChunkmithril_doc||[]).push([[9337],{35005:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"mithril/advanced/mithril-certification/cardano-node-database-v2","title":"Cardano node database v2","description":"- This new incremental certification will supersede the current certification process for the Cardano node internal database.","source":"@site/root/mithril/advanced/mithril-certification/cardano-node-database-v2.md","sourceDirName":"mithril/advanced/mithril-certification","slug":"/mithril/advanced/mithril-certification/cardano-node-database-v2","permalink":"/doc/next/mithril/advanced/mithril-certification/cardano-node-database-v2","draft":false,"unlisted":false,"editUrl":"https://github.com/input-output-hk/mithril/edit/main/docs/website/root/mithril/advanced/mithril-certification/cardano-node-database-v2.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"sidebar_label":"Cardano node database v2"},"sidebar":"mithrilSideBar","previous":{"title":"Cardano node database","permalink":"/doc/next/mithril/advanced/mithril-certification/cardano-node-database"},"next":{"title":"Mithril network","permalink":"/doc/next/mithril/advanced/mithril-network/"}}');var a=i(74848),r=i(28453);const s={sidebar_position:4,sidebar_label:"Cardano node database v2"},o="Cardano node database v2",d={},l=[{value:"Mithril certification",id:"mithril-certification",level:2},{value:"Message computation",id:"message-computation",level:3},{value:"Authenticity verification",id:"authenticity-verification",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"cardano-node-database-v2",children:"Cardano node database v2"})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["This new incremental certification will supersede the current ",(0,a.jsx)(n.a,{href:"/doc/next/mithril/advanced/mithril-certification/cardano-node-database",children:"certification"})," process for the Cardano node internal database."]}),"\n",(0,a.jsxs)(n.li,{children:["The rollout of this new certification is detailed in this ",(0,a.jsx)(n.a,{href:"https://mithril.network/doc/dev-blog/2025/06/17/client-cli-cardano-database-backends",children:"blog post"}),"."]}),"\n"]})}),"\n",(0,a.jsxs)(n.p,{children:["The Mithril protocol supports the incremental certification of the ",(0,a.jsx)(n.strong,{children:"Cardano node internal database"}),", enabling fast bootstrapping of a Cardano node on a ",(0,a.jsx)(n.strong,{children:"specific range of immutable files"}),". This is particularly useful for full-node wallets, SPOs, and layer 2 protocols that need to operate full Cardano nodes and want to synchronize them quickly after an offline period."]}),"\n",(0,a.jsx)(n.p,{children:"To achieve this, Mithril signers and aggregators independently compute a message representing the immutable files of the Cardano node internal database and apply the Mithril protocol to jointly sign it."}),"\n",(0,a.jsxs)(n.p,{children:["A natural structure for the message is a ",(0,a.jsx)(n.strong,{children:"Merkle tree"}),", which:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Can be succinctly represented by its ",(0,a.jsx)(n.strong,{children:"Merkle root"})," (the signed message)"]}),"\n",(0,a.jsxs)(n.li,{children:["Enables membership proof of an immutable file by providing the ",(0,a.jsx)(n.strong,{children:"Merkle path"})," from the transaction to the root."]}),"\n"]}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsx)(n.p,{children:"The Cardano node internal database:"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Exceeds ",(0,a.jsx)(n.code,{children:"150 GB"})," on the Cardano mainnet"]}),"\n",(0,a.jsxs)(n.li,{children:["Holds less than ",(0,a.jsx)(n.code,{children:"20,000"})," immutable files on the Cardano mainnet"]}),"\n",(0,a.jsxs)(n.li,{children:["Can be fully bootstrapped in ",(0,a.jsx)(n.code,{children:"~20 minutes"})," with Mithril"]}),"\n",(0,a.jsxs)(n.li,{children:["Takes over ",(0,a.jsx)(n.code,{children:"24 hours"})," without Mithril."]}),"\n"]})]}),"\n",(0,a.jsx)(n.h2,{id:"mithril-certification",children:"Mithril certification"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(83846).A+"",children:(0,a.jsx)(n.img,{alt:"Design of the certification of the Cardano node internal database v2",src:i(22042).A+"",width:"1366",height:"731"})}),"\n",(0,a.jsx)("small",{children:(0,a.jsx)("center",{children:"End-to-end certification for Cardano transactions"})})]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Learn about the Mithril certification steps ",(0,a.jsx)(n.a,{href:"/doc/next/mithril/advanced/mithril-certification/",children:"here"}),"."]})}),"\n",(0,a.jsx)(n.h3,{id:"message-computation",children:"Message computation"}),"\n",(0,a.jsx)(n.p,{children:"The message is the root of the Merkle tree composed of the hash of the immutable files in the Cardano node internal database:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["The hash of the immutable files is computed with ",(0,a.jsx)(n.code,{children:"SHA256"})," of their binary content"]}),"\n",(0,a.jsx)(n.li,{children:"The last immutable file, the ledger state, and the volatile cannot be signed as the Cardano node does not deterministically compute them."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The message computation is the same on the signers and the aggregators."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(26428).A+"",children:(0,a.jsx)(n.img,{alt:"Design of the certification of the Cardano node internal database v2",src:i(87488).A+"",width:"1438",height:"695"})}),"\n",(0,a.jsx)("small",{children:(0,a.jsx)("center",{children:"Message creation on the signers and aggregators"})})]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["The Merkle tree inner nodes are computed with the ",(0,a.jsx)(n.code,{children:"BLAKE2s-256"})," hash function: the child bytes are concatenated and hashed to compute the parent node."]})}),"\n",(0,a.jsx)(n.h3,{id:"authenticity-verification",children:"Authenticity verification"}),"\n",(0,a.jsx)(n.p,{children:"Since the number of immutable files in the Cardano node\u2019s internal database is small, computing the Merkle tree is fast and can be performed on the client side."}),"\n",(0,a.jsx)(n.p,{children:"The verification process for a subset of immutable files in the Cardano internal database operates as follows:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["The client downloads data from one or more untrusted sources (eg, an aggregator or a cloud service):","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A compressed artifact of the partial range of immutable files to restore"}),"\n",(0,a.jsx)(n.li,{children:"A map of the digests of immutable files in the Cardano node internal database"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"The client computes the same Merkle tree as the signers and aggregators using the fetched digests"}),"\n",(0,a.jsxs)(n.li,{children:["The client computes a Merkle proof of membership for the downloaded immutable files, ensuring that:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The proof is derived from the computed Merkle tree"}),"\n",(0,a.jsx)(n.li,{children:"The proof is valid"}),"\n",(0,a.jsx)(n.li,{children:"The Merkle root is signed by a valid Mithril certificate."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(90863).A+"",children:(0,a.jsx)(n.img,{alt:"Design of the certification of the Cardano node internal database v2",src:i(54955).A+"",width:"1349",height:"741"})}),"\n",(0,a.jsx)("small",{children:(0,a.jsx)("center",{children:"Proof creation on the clients"})})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},83846:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/end-to-end-process-0b184eb4b8a293a232c219cb92ff972a.jpg"},26428:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/message-fb5d7b5eff3242f57e99e02ad6c77496.jpg"},90863:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/files/proof-client-bbf8c80e3f5d78b6eea7848b097aedb0.jpg"},22042:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/end-to-end-process-0b184eb4b8a293a232c219cb92ff972a.jpg"},87488:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/message-fb5d7b5eff3242f57e99e02ad6c77496.jpg"},54955:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/proof-client-bbf8c80e3f5d78b6eea7848b097aedb0.jpg"},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>o});var t=i(96540);const a={},r=t.createContext(a);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);